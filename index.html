<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2026 Mahjong Tracker</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; max-width: 900px; margin: 0 auto; padding: 20px; background: #f8f9fa; color: #333; }
    h1 { text-align: center; margin-bottom: 10px; }
    #subtitle { text-align: center; color: #666; margin-bottom: 30px; }
    #summary { display: flex; justify-content: space-around; flex-wrap: wrap; gap: 15px; margin-bottom: 20px; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .player-sum { text-align: center; min-width: 100px; }
    .player-sum strong { display: block; font-size: 1.2em; }
    .net-positive { color: #28a745; }
    .net-negative { color: #dc3545; }
    #nav { text-align: center; margin-bottom: 20px; }
    button { background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 16px; margin: 0 5px; }
    button:hover { background: #0056b3; }
    #calendar { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .weekdays { display: flex; font-weight: bold; background: #e9ecef; border-radius: 8px; padding: 10px; margin-bottom: 10px; }
    .weekday { flex: 1; text-align: center; color: #495057; }
    .week { display: flex; margin-bottom: 4px; }
    .day { flex: 1; height: 80px; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 2px solid #dee2e6; border-radius: 8px; margin: 0 2px; cursor: pointer; font-weight: bold; transition: all 0.2s; background: white; }
    .day:hover { border-color: #007bff; transform: scale(1.05); }
    .day.other-month { color: #adb5bd; border-color: #e9ecef; cursor: default; background: #f8f9fa; }
    .day.other-month:hover { transform: none; border-color: #e9ecef; }
    .day.editing { border-color: #28a745; background: #e9f7ef !important; }
    .day input { width: 60px; height: 32px; border: 1px solid #ced4da; border-radius: 6px; text-align: center; font-size: 16px; font-weight: bold; }
    .day.net-positive { background: #d4edda; border-color: #28a745; }
    .day.net-negative { background: #f8d7da; border-color: #dc3545; }
    #status { text-align: center; margin-top: 15px; font-style: italic; color: #666; }
  </style>
</head>
<body>
  <h1>2026 Mahjong Tracker</h1>
  <p id="subtitle">Track net points per player (+ = wins, – = losses)</p>
  
  <div id="summary"></div>
  
  <div id="nav">
    <button onclick="prevMonth()">← Prev Month</button>
    <span id="month-year" style="font-size: 18px; font-weight: bold; margin: 0 25px;"></span>
    <button onclick="nextMonth()">Next Month →</button>
  </div>
  
  <div id="calendar"></div>
  <p id="status">Click a day → enter net for each player (+ positive / – negative) → Tab/Enter/click away to save. Data saved in browser.</p>

  <script>
    const players = ['Gina', 'Anders', 'Kaylee', 'Philip', 'Rosie', 'Anfern'];
    const POINTS_PER_UNIT = 10; // $10 per point/unit – change if different
    let currentYear = 2026;
    let currentMonth = 0; // 0 = January
    let data = {}; // { '2026-1-15': {Gina: 3, Anders: -2, ...} }

    function loadData() {
      const saved = localStorage.getItem('mj2026-net');
      data = saved ? JSON.parse(saved) : {};
    }

    function saveData() {
      localStorage.setItem('mj2026-net', JSON.stringify(data));
    }

    function daysInMonth(y, m) {
      return new Date(y, m + 1, 0).getDate();
    }

    function firstDayOfMonth(y, m) {
      return new Date(y, m, 1).getDay();
    }

    function calcSummary(y, m) {
      const nets = {};
      players.forEach(p => nets[p] = 0);
      for (let d = 1; d <= daysInMonth(y, m); d++) {
        const key = `${y}-${m + 1}-${d}`;
        if (data[key]) {
          players.forEach(p => {
            nets[p] += (data[key][p] || 0) * POINTS_PER_UNIT;
          });
        }
      }
      return nets;
    }

    function updateSummary() {
      const nets = calcSummary(currentYear, currentMonth);
      const sumDiv = document.getElementById('summary');
      sumDiv.innerHTML = players.map(p => {
        const net = nets[p];
        const sign = net > 0 ? '+' : '';
        const cls = net > 0 ? 'net-positive' : net < 0 ? 'net-negative' : '';
        return `<div class="player-sum ${cls}"><strong>${p}</strong><br>${sign}${net}$</div>`;
      }).join('');
    }

    function updateCalendar() {
      document.getElementById('month-year').textContent = 
        new Date(currentYear, currentMonth, 1).toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
      
      const cal = document.getElementById('calendar');
      const daysInCur = daysInMonth(currentYear, currentMonth);
      const firstDOW = firstDayOfMonth(currentYear, currentMonth);
      
      let html = '<div class="weekdays">' + 
        ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].map(d => `<div class="weekday">${d}</div>`).join('') + 
        '</div>';

      let week = [];
      for (let i = 0; i < firstDOW; i++) {
        const prevD = daysInMonth(currentYear, currentMonth - 1) - firstDOW + i + 1;
        week.push(`<div class="day other-month">${prevD}</div>`);
      }
      
      for (let d = 1; d <= daysInCur; d++) {
        week.push(createDay(d));
        if (week.length === 7) {
          html += `<div class="week">${week.join('')}</div>`;
          week = [];
        }
      }
      
      while (week.length < 7) {
        week.push(`<div class="day other-month"></div>`);
      }
      if (week.length) html += `<div class="week">${week.join('')}</div>`;
      
      cal.innerHTML = html;
      updateSummary();
    }

    function createDay(d) {
      const key = `${currentYear}-${currentMonth + 1}-${d}`;
      const dayData = data[key] || {};
      const totalNet = players.reduce((sum, p) => sum + (dayData[p] || 0), 0);
      const dayCls = totalNet > 0 ? 'net-positive' : totalNet < 0 ? 'net-negative' : '';
      return `<div class="day ${dayCls}" onclick="editDay('${key}', this)">${d}</div>`;
    }

    function editDay(key, elem) {
      if (elem.classList.contains('editing')) return;
      elem.classList.add('editing');
      
      const dayData = data[key] || {};
      let html = '';
      players.forEach(p => {
        const val = dayData[p] ?? '';
        html += `
          <div style="font-size:11px; color:#555; margin-bottom:3px;">${p}</div>
          <input type="number" value="${val}" 
                 onblur="saveNet('${key}', '${p}', this)" 
                 onkeypress="if(event.key==='Enter') this.blur()">
        `;
      });
      elem.innerHTML = html;
      elem.querySelector('input').focus();
    }

    function saveNet(key, player, input) {
      const val = parseInt(input.value) || 0;
      if (!data[key]) data[key] = {};
      if (val === 0) {
        delete data[key][player]; // clean up zeros
      } else {
        data[key][player] = val;
      }
      if (Object.keys(data[key]).length === 0) delete data[key];
      saveData();
      updateCalendar();
    }

    function prevMonth() {
      currentMonth--;
      if (currentMonth < 0) { currentMonth = 11; currentYear--; }
      updateCalendar();
    }

    function nextMonth() {
      currentMonth++;
      if (currentMonth > 11) { currentMonth = 0; currentYear++; }
      updateCalendar();
    }

    // Init
    loadData();
    updateCalendar();
  </script>
</body>
</html>
